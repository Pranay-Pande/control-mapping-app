# Control Mapping Task

## Objective
Map compliance controls from the framework document to {provider} security checks.

## Framework Information
- Name: {framework_name}
- Version: {framework_version}
- Provider Target: {provider}

## Source Document
The framework document is located at: {file_path}
Please read and analyze this file to extract all controls.

## Field Mapping Instructions
{field_mappings}

## Available Security Checks
The checks are stored in: providers/{provider}/services/
Browse this folder recursively to find all *.metadata.json files.

Each check metadata file contains:
- CheckID: The identifier to use in the "Checks" array
- CheckTitle: Human-readable check name
- Description: What the check verifies
- ServiceName: Target cloud service
- Severity: Check severity level
- Categories: Grouping categories

## Additional Instructions
{custom_instructions}

## Required Output Format
Return a JSON object with this exact structure:

{output_format}

IMPORTANT NOTES:
1. In the "Checks" array, use the exact "CheckID" values from the metadata files.
2. For "Attributes", extract BOTH Section AND SubSection from the document:
   - Section: The main category/domain (e.g., "Access Control (AC)")
   - SubSection: The sub-category within the section (e.g., "Account Management (AC-2)")
3. If the document has hierarchical structure, preserve it in Section/SubSection.
4. The "Service" field in Attributes should reflect the cloud service category.

Begin by reading the framework document, then browse the providers/{provider}/services/ folder recursively, and finally output the mapping JSON.
